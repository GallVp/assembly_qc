Changes in module 'nf-core/fastk/fastk'
--- modules/nf-core/fastk/fastk/environment.yml
+++ modules/nf-core/fastk/fastk/environment.yml
@@ -3,3 +3,5 @@
   - conda-forge
   - bioconda
   - defaults
+dependencies:
+  - bioconda::false_flag # False flag to pass nf-core/lint

--- modules/nf-core/fastk/fastk/meta.yml
+++ modules/nf-core/fastk/fastk/meta.yml
@@ -9,7 +9,7 @@
       description: "A fast K-mer counter for high-fidelity shotgun datasets"
       homepage: "https://github.com/thegenemyers/FASTK"
       tool_dev_url: "https://github.com/thegenemyers/FASTK"
-      licence: "https://github.com/thegenemyers/FASTK/blob/master/LICENSE"
+      licence: ["https://github.com/thegenemyers/FASTK/blob/master/LICENSE"]
 input:
   - meta:
       type: map
@@ -47,3 +47,4 @@
   - "@mahesh-panchal"
 maintainers:
   - "@mahesh-panchal"
+  - "@gallvp"

--- modules/nf-core/fastk/fastk/main.nf
+++ modules/nf-core/fastk/fastk/main.nf
@@ -38,4 +38,34 @@
         fastk: $FASTK_VERSION
     END_VERSIONS
     """
+
+    stub:
+    // Exit if running this module with -profile conda / -profile mamba
+    if (workflow.profile.tokenize(',').intersect(['conda', 'mamba']).size() >= 1) {
+        error "FASTK_FASTK module does not support Conda. Please use Docker / Singularity / Podman instead."
+    }
+    def args = task.ext.args ?: ''
+    def prefix = task.ext.prefix ?: "${meta.id}"
+    def FASTK_VERSION = 'f18a4e6d2207539f7b84461daebc54530a9559b0' // WARN: Version information not provided by tool on CLI. Please update this string when bumping container versions.
+
+    def touch_ktab = args.contains('-t') ? "touch ${prefix}_fk.ktab .${prefix}_fk.ktab.1" : ''
+    def touch_prof = args.contains('-p') ? "touch ${prefix}_fk.prof .${prefix}_fk.pidx.1" : ''
+    """
+    touch ${prefix}_fk.hist
+    $touch_ktab
+    $touch_prof
+
+    echo \\
+    "FastK \\
+        $args \\
+        -T$task.cpus \\
+        -M${task.memory.toGiga()} \\
+        -N${prefix}_fk \\
+        $reads"
+
+    cat <<-END_VERSIONS > versions.yml
+    "${task.process}":
+        fastk: $FASTK_VERSION
+    END_VERSIONS
+    """
 }

--- /dev/null
+++ modules/nf-core/fastk/fastk/tests/main.nf.test.snap
@@ -0,0 +1,346 @@
+{
+    "test_fastk_fastk_single_end_stub": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test_fk.hist:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.ktab:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.prof:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "3": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ],
+                "hist": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test_fk.hist:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "ktab": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.ktab:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "prof": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.prof:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T19:39:28.510263"
+    },
+    "test_fastk_fastk_single_end": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test_fk.hist:md5,c80e12f7321e62dba4b437d7bff36ec0"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,ceeacd0cb3aa69bf9b2a402830b40e26",
+                            ".test_fk.ktab.2:md5,f2629fd15b285aed3dc2d5fe546edf3f",
+                            "test_fk.ktab:md5,a605a58931a4b5029469e1c2575c8cee"
+                        ]
+                    ]
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,90bc384f61d2ecdb4586ab52ab04fddf",
+                            ".test_fk.prof.1:md5,ebd48923a724cf79934f0b2ed42ba73d",
+                            "test_fk.prof:md5,43d426c95d277b8148406624d513bd40"
+                        ]
+                    ]
+                ],
+                "3": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ],
+                "hist": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test_fk.hist:md5,c80e12f7321e62dba4b437d7bff36ec0"
+                    ]
+                ],
+                "ktab": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,ceeacd0cb3aa69bf9b2a402830b40e26",
+                            ".test_fk.ktab.2:md5,f2629fd15b285aed3dc2d5fe546edf3f",
+                            "test_fk.ktab:md5,a605a58931a4b5029469e1c2575c8cee"
+                        ]
+                    ]
+                ],
+                "prof": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,90bc384f61d2ecdb4586ab52ab04fddf",
+                            ".test_fk.prof.1:md5,ebd48923a724cf79934f0b2ed42ba73d",
+                            "test_fk.prof:md5,43d426c95d277b8148406624d513bd40"
+                        ]
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T19:31:31.128388"
+    },
+    "test_fastk_fastk_paired_end": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        "test_fk.hist:md5,4f75b550d87ed4f26a2b10a05ac7e98c"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,7f28fb44940fda799797e3069f5d7263",
+                            ".test_fk.ktab.2:md5,c14a85c128926ace78372f09029977b1",
+                            "test_fk.ktab:md5,fddd5be0c36ad1d2131b8d8774f7657a"
+                        ]
+                    ]
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,e7e760f714070a4afefb38ffff559684",
+                            ".test_fk.pidx.2:md5,a549612bbdba2506eb3311237638c4b0",
+                            ".test_fk.prof.1:md5,46a5fd9e297262b058f8c1fd062fcf56",
+                            ".test_fk.prof.2:md5,80326a7406f41ccf2e51e341fc804132",
+                            "test_fk.prof:md5,d3c7d8decd4ea6e298291b8be0e2de85"
+                        ]
+                    ]
+                ],
+                "3": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ],
+                "hist": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        "test_fk.hist:md5,4f75b550d87ed4f26a2b10a05ac7e98c"
+                    ]
+                ],
+                "ktab": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,7f28fb44940fda799797e3069f5d7263",
+                            ".test_fk.ktab.2:md5,c14a85c128926ace78372f09029977b1",
+                            "test_fk.ktab:md5,fddd5be0c36ad1d2131b8d8774f7657a"
+                        ]
+                    ]
+                ],
+                "prof": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,e7e760f714070a4afefb38ffff559684",
+                            ".test_fk.pidx.2:md5,a549612bbdba2506eb3311237638c4b0",
+                            ".test_fk.prof.1:md5,46a5fd9e297262b058f8c1fd062fcf56",
+                            ".test_fk.prof.2:md5,80326a7406f41ccf2e51e341fc804132",
+                            "test_fk.prof:md5,d3c7d8decd4ea6e298291b8be0e2de85"
+                        ]
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T19:31:35.565502"
+    },
+    "test_fastk_fastk_paired_end_stub": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        "test_fk.hist:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.ktab:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.prof:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "3": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ],
+                "hist": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        "test_fk.hist:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "ktab": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.ktab.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.ktab:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "prof": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": false
+                        },
+                        [
+                            ".test_fk.pidx.1:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test_fk.prof:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c216a1608924d1662d2086e1de1d5abd"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T19:39:32.570957"
+    }
+}
--- /dev/null
+++ modules/nf-core/fastk/fastk/tests/tags.yml
@@ -0,0 +1,2 @@
+fastk/fastk:
+  - "modules/nf-core/fastk/fastk/**"

--- /dev/null
+++ modules/nf-core/fastk/fastk/tests/nextflow.config
@@ -0,0 +1,3 @@
+process {
+    ext.args = '-t -p'
+}

--- /dev/null
+++ modules/nf-core/fastk/fastk/tests/main.nf.test
@@ -0,0 +1,110 @@
+nextflow_process {
+
+    name "Test Process FASTK_FASTK"
+    script "../main.nf"
+    config './nextflow.config'
+    process "FASTK_FASTK"
+
+    tag "modules"
+    tag "modules_nfcore"
+    tag "fastk"
+    tag "fastk/fastk"
+
+    test("test_fastk_fastk_single_end") {
+        when {
+            process {
+                """
+                input[0] = [
+                    [ id:'test' , single_end: true ], // meta map
+                    file(params.test_data['sarscov2']['illumina']['test_1_fastq_gz'], checkIfExists: true)
+                ]
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+
+    }
+
+    test("test_fastk_fastk_paired_end") {
+
+        when {
+            process {
+                """
+                input[0] = [
+                    [ id:'test' , single_end: false ], // meta map
+                    [
+                        file(params.test_data['sarscov2']['illumina']['test_1_fastq_gz'], checkIfExists: true),
+                        file(params.test_data['sarscov2']['illumina']['test_2_fastq_gz'], checkIfExists: true)
+                    ]
+                ]
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+
+    }
+
+    test("test_fastk_fastk_single_end_stub") {
+
+        options '-stub'
+
+        when {
+            process {
+                """
+                input[0] = [
+                    [ id:'test' , single_end: true ], // meta map
+                    file(params.test_data['sarscov2']['illumina']['test_1_fastq_gz'], checkIfExists: true)
+                ]
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+
+    }
+
+    test("test_fastk_fastk_paired_end_stub") {
+
+        options '-stub'
+
+        when {
+            process {
+                """
+                input[0] = [
+                    [ id:'test' , single_end: false ], // meta map
+                    [
+                        file(params.test_data['sarscov2']['illumina']['test_1_fastq_gz'], checkIfExists: true),
+                        file(params.test_data['sarscov2']['illumina']['test_2_fastq_gz'], checkIfExists: true)
+                    ]
+                ]
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+
+    }
+
+}

************************************************************
