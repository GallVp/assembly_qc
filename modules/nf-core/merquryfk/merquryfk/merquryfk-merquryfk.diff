Changes in module 'nf-core/merquryfk/merquryfk'
--- modules/nf-core/merquryfk/merquryfk/environment.yml
+++ modules/nf-core/merquryfk/merquryfk/environment.yml
@@ -3,3 +3,5 @@
   - conda-forge
   - bioconda
   - defaults
+dependencies:
+  - bioconda::false_flag # False flag to pass nf-core/lint

--- modules/nf-core/merquryfk/merquryfk/meta.yml
+++ modules/nf-core/merquryfk/merquryfk/meta.yml
@@ -9,7 +9,7 @@
       description: "FastK based version of Merqury"
       homepage: "https://github.com/thegenemyers/MERQURY.FK"
       tool_dev_url: "https://github.com/thegenemyers/MERQURY.FK"
-      licence: "https://github.com/thegenemyers/MERQURY.FK/blob/main/LICENSE"
+      licence: ["https://github.com/thegenemyers/MERQURY.FK/blob/main/LICENSE"]
 input:
   - meta:
       type: map
@@ -110,3 +110,4 @@
   - "@mahesh-panchal"
 maintainers:
   - "@mahesh-panchal"
+  - "@gallvp"

--- modules/nf-core/merquryfk/merquryfk/main.nf
+++ modules/nf-core/merquryfk/merquryfk/main.nf
@@ -55,4 +55,45 @@
         r: \$( R --version | sed '1!d; s/.*version //; s/ .*//' )
     END_VERSIONS
     """
+
+    stub:
+    // Exit if running this module with -profile conda / -profile mamba
+    if (workflow.profile.tokenize(',').intersect(['conda', 'mamba']).size() >= 1) {
+        error "MERQURYFK_MERQURYFK module does not support Conda. Please use Docker / Singularity / Podman instead."
+    }
+    def args = task.ext.args ?: ''
+    prefix = task.ext.prefix ?: "${meta.id}"
+    def FASTK_VERSION = 'f18a4e6d2207539f7b84461daebc54530a9559b0' // WARN: Version information not provided by tool on CLI. Please update this string when bumping container versions.
+    def MERQURY_VERSION = '8ae344092df5dcaf83cfb7f90f662597a9b1fc61' // WARN: Version information not provided by tool on CLI. Please update this string when bumping container versions.
+
+    def touch_asm_bed   = "touch ${prefix}.${assembly.baseName}_only.bed"
+    def touch_asm_qv    = "touch ${prefix}.${assembly.baseName}.qv"
+    def touch_haplo_bed = haplotigs ? "touch ${prefix}.${haplotigs.baseName}_only.bed" : ''
+    def touch_haplo_qv  = haplotigs ? "touch ${prefix}.${haplotigs.baseName}.qv" : ''
+    """
+    touch "${prefix}.completeness.stats"
+
+    $touch_asm_bed
+    $touch_asm_qv
+    $touch_haplo_bed
+    $touch_haplo_qv
+
+    touch "${prefix}.qv"
+
+    echo \\
+    "MerquryFK \\
+        $args \\
+        -T$task.cpus \\
+        ${fastk_ktab.find{ it.toString().endsWith(".ktab") }} \\
+        $assembly \\
+        $haplotigs \\
+        $prefix"
+
+    cat <<-END_VERSIONS > versions.yml
+    "${task.process}":
+        fastk: $FASTK_VERSION
+        merquryfk: $MERQURY_VERSION
+        r: \$( R --version | sed '1!d; s/.*version //; s/ .*//' )
+    END_VERSIONS
+    """
 }

--- /dev/null
+++ modules/nf-core/merquryfk/merquryfk/tests/main.nf.test.snap
@@ -0,0 +1,802 @@
+{
+    "multiple_minimal_stub": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            "test.genome2_only.bed:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test.genome_only.bed:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "10": [
+                    
+                ],
+                "11": [
+                    
+                ],
+                "12": [
+                    
+                ],
+                "13": [
+                    
+                ],
+                "14": [
+                    
+                ],
+                "15": [
+                    
+                ],
+                "16": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            "test.genome.qv:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test.genome2.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "3": [
+                    
+                ],
+                "4": [
+                    
+                ],
+                "5": [
+                    
+                ],
+                "6": [
+                    
+                ],
+                "7": [
+                    
+                ],
+                "8": [
+                    
+                ],
+                "9": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "assembly_qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            "test.genome.qv:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test.genome2.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "bed": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        [
+                            "test.genome2_only.bed:md5,d41d8cd98f00b204e9800998ecf8427e",
+                            "test.genome_only.bed:md5,d41d8cd98f00b204e9800998ecf8427e"
+                        ]
+                    ]
+                ],
+                "qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "spectra_asm_fl_pdf": [
+                    
+                ],
+                "spectra_asm_fl_png": [
+                    
+                ],
+                "spectra_asm_ln_pdf": [
+                    
+                ],
+                "spectra_asm_ln_png": [
+                    
+                ],
+                "spectra_asm_st_pdf": [
+                    
+                ],
+                "spectra_asm_st_png": [
+                    
+                ],
+                "spectra_cn_fl_pdf": [
+                    
+                ],
+                "spectra_cn_fl_png": [
+                    
+                ],
+                "spectra_cn_ln_pdf": [
+                    
+                ],
+                "spectra_cn_ln_png": [
+                    
+                ],
+                "spectra_cn_st_pdf": [
+                    
+                ],
+                "spectra_cn_st_png": [
+                    
+                ],
+                "stats": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T20:21:30.488412"
+    },
+    "test_merquryfk_merquryfk_pdf": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,797224fa75606bbda7f62caae7c9151c"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome_only.bed:md5,662d73e8a0019708feb538ec53c220f7"
+                    ]
+                ],
+                "10": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.fl.png:md5,bb9ac38fe8991fbacbe791e562626d89"
+                    ]
+                ],
+                "11": [
+                    
+                ],
+                "12": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.ln.png:md5,48534a9d5e2ce9365eb1f0397c76f337"
+                    ]
+                ],
+                "13": [
+                    
+                ],
+                "14": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.st.png:md5,5e031a8b9ba2800e291721a11f4d9c00"
+                    ]
+                ],
+                "15": [
+                    
+                ],
+                "16": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.qv:md5,1e11be8abfa2230024042832f58f96f9"
+                    ]
+                ],
+                "3": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.fl.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "4": [
+                    
+                ],
+                "5": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.ln.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "6": [
+                    
+                ],
+                "7": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.st.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "8": [
+                    
+                ],
+                "9": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,02b4d5c639ca706ff707bad89e29d90e"
+                    ]
+                ],
+                "assembly_qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.qv:md5,1e11be8abfa2230024042832f58f96f9"
+                    ]
+                ],
+                "bed": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome_only.bed:md5,662d73e8a0019708feb538ec53c220f7"
+                    ]
+                ],
+                "qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,02b4d5c639ca706ff707bad89e29d90e"
+                    ]
+                ],
+                "spectra_asm_fl_pdf": [
+                    
+                ],
+                "spectra_asm_fl_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.fl.png:md5,bb9ac38fe8991fbacbe791e562626d89"
+                    ]
+                ],
+                "spectra_asm_ln_pdf": [
+                    
+                ],
+                "spectra_asm_ln_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.ln.png:md5,48534a9d5e2ce9365eb1f0397c76f337"
+                    ]
+                ],
+                "spectra_asm_st_pdf": [
+                    
+                ],
+                "spectra_asm_st_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.st.png:md5,5e031a8b9ba2800e291721a11f4d9c00"
+                    ]
+                ],
+                "spectra_cn_fl_pdf": [
+                    
+                ],
+                "spectra_cn_fl_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.fl.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "spectra_cn_ln_pdf": [
+                    
+                ],
+                "spectra_cn_ln_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.ln.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "spectra_cn_st_pdf": [
+                    
+                ],
+                "spectra_cn_st_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.st.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "stats": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,797224fa75606bbda7f62caae7c9151c"
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T19:58:05.545683"
+    },
+    "single_minimal_stub": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome_only.bed:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "10": [
+                    
+                ],
+                "11": [
+                    
+                ],
+                "12": [
+                    
+                ],
+                "13": [
+                    
+                ],
+                "14": [
+                    
+                ],
+                "15": [
+                    
+                ],
+                "16": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "3": [
+                    
+                ],
+                "4": [
+                    
+                ],
+                "5": [
+                    
+                ],
+                "6": [
+                    
+                ],
+                "7": [
+                    
+                ],
+                "8": [
+                    
+                ],
+                "9": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "assembly_qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "bed": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome_only.bed:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "spectra_asm_fl_pdf": [
+                    
+                ],
+                "spectra_asm_fl_png": [
+                    
+                ],
+                "spectra_asm_ln_pdf": [
+                    
+                ],
+                "spectra_asm_ln_png": [
+                    
+                ],
+                "spectra_asm_st_pdf": [
+                    
+                ],
+                "spectra_asm_st_png": [
+                    
+                ],
+                "spectra_cn_fl_pdf": [
+                    
+                ],
+                "spectra_cn_fl_png": [
+                    
+                ],
+                "spectra_cn_ln_pdf": [
+                    
+                ],
+                "spectra_cn_ln_png": [
+                    
+                ],
+                "spectra_cn_st_pdf": [
+                    
+                ],
+                "spectra_cn_st_png": [
+                    
+                ],
+                "stats": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,d41d8cd98f00b204e9800998ecf8427e"
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T20:21:19.606389"
+    },
+    "test_merquryfk_merquryfk_png": {
+        "content": [
+            {
+                "0": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,797224fa75606bbda7f62caae7c9151c"
+                    ]
+                ],
+                "1": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome_only.bed:md5,662d73e8a0019708feb538ec53c220f7"
+                    ]
+                ],
+                "10": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.fl.png:md5,bb9ac38fe8991fbacbe791e562626d89"
+                    ]
+                ],
+                "11": [
+                    
+                ],
+                "12": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.ln.png:md5,48534a9d5e2ce9365eb1f0397c76f337"
+                    ]
+                ],
+                "13": [
+                    
+                ],
+                "14": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.st.png:md5,5e031a8b9ba2800e291721a11f4d9c00"
+                    ]
+                ],
+                "15": [
+                    
+                ],
+                "16": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ],
+                "2": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.qv:md5,1e11be8abfa2230024042832f58f96f9"
+                    ]
+                ],
+                "3": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.fl.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "4": [
+                    
+                ],
+                "5": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.ln.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "6": [
+                    
+                ],
+                "7": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.st.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "8": [
+                    
+                ],
+                "9": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,02b4d5c639ca706ff707bad89e29d90e"
+                    ]
+                ],
+                "assembly_qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.qv:md5,1e11be8abfa2230024042832f58f96f9"
+                    ]
+                ],
+                "bed": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome_only.bed:md5,662d73e8a0019708feb538ec53c220f7"
+                    ]
+                ],
+                "qv": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.qv:md5,02b4d5c639ca706ff707bad89e29d90e"
+                    ]
+                ],
+                "spectra_asm_fl_pdf": [
+                    
+                ],
+                "spectra_asm_fl_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.fl.png:md5,bb9ac38fe8991fbacbe791e562626d89"
+                    ]
+                ],
+                "spectra_asm_ln_pdf": [
+                    
+                ],
+                "spectra_asm_ln_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.ln.png:md5,48534a9d5e2ce9365eb1f0397c76f337"
+                    ]
+                ],
+                "spectra_asm_st_pdf": [
+                    
+                ],
+                "spectra_asm_st_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.spectra-asm.st.png:md5,5e031a8b9ba2800e291721a11f4d9c00"
+                    ]
+                ],
+                "spectra_cn_fl_pdf": [
+                    
+                ],
+                "spectra_cn_fl_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.fl.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "spectra_cn_ln_pdf": [
+                    
+                ],
+                "spectra_cn_ln_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.ln.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "spectra_cn_st_pdf": [
+                    
+                ],
+                "spectra_cn_st_png": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.genome.spectra-cn.st.png:md5,50bad6b85b8f80b8411b50e4119bc959"
+                    ]
+                ],
+                "stats": [
+                    [
+                        {
+                            "id": "test",
+                            "single_end": true
+                        },
+                        "test.completeness.stats:md5,797224fa75606bbda7f62caae7c9151c"
+                    ]
+                ],
+                "versions": [
+                    "versions.yml:md5,c28c863a18f7ad02798270acd2e6aa48"
+                ]
+            }
+        ],
+        "meta": {
+            "nf-test": "0.8.4",
+            "nextflow": "23.10.1"
+        },
+        "timestamp": "2024-05-18T19:57:31.981156"
+    }
+}
--- /dev/null
+++ modules/nf-core/merquryfk/merquryfk/tests/tags.yml
@@ -0,0 +1,2 @@
+merquryfk/merquryfk:
+  - "modules/nf-core/merquryfk/merquryfk/**"

--- /dev/null
+++ modules/nf-core/merquryfk/merquryfk/tests/nextflow.config
@@ -0,0 +1,11 @@
+process {
+    withName: 'FASTK_.*' {
+        ext.args   = '-t'
+    }
+    withName: 'test_merquryfk_merquryfk_png:MERQURYFK_MERQURYFK' {
+        ext.args   = '-lfs'
+    }
+    withName: 'test_merquryfk_merquryfk_pdf:MERQURYFK_MERQURYFK' {
+        ext.args   = '-lfs -pdf'
+    }
+}

--- /dev/null
+++ modules/nf-core/merquryfk/merquryfk/tests/main.nf.test
@@ -0,0 +1,153 @@
+nextflow_process {
+
+    name "Test Process MERQURYFK_MERQURYFK"
+    script "../main.nf"
+    config "./nextflow.config"
+    process "MERQURYFK_MERQURYFK"
+
+    tag "modules"
+    tag "modules_nfcore"
+    tag "merquryfk"
+    tag "merquryfk/merquryfk"
+    tag "fastk/fastk"
+
+    setup {
+        run("FASTK_FASTK") {
+            script "../../../fastk/fastk"
+            process {
+                """
+                input[0] =  [
+                    [ id:'test', single_end:true ], // meta map
+                    file(params.test_data['homo_sapiens']['illumina']['test_1_fastq_gz'], checkIfExists: true)
+                ]
+                """
+            }
+        }
+    }
+
+    test("test_merquryfk_merquryfk_png") {
+
+        when {
+            process {
+                """
+                assembly = [
+                    [ id:'test', single_end:true ], // meta map
+                    file(params.test_data['homo_sapiens']['genome']['genome_fasta'], checkIfExists: true)
+                ]
+
+                haplotigs = [
+                    [ id:'test', single_end:true ], []
+                ]
+
+                input[0] = FASTK_FASTK.out.hist
+                            | join( FASTK_FASTK.out.ktab )
+                            | join( Channel.value( assembly ) )
+                            | join( Channel.value( haplotigs ) )
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+    }
+
+    test("test_merquryfk_merquryfk_pdf") {
+
+        when {
+            process {
+                """
+                assembly = [
+                    [ id:'test', single_end:true ], // meta map
+                    file(params.test_data['homo_sapiens']['genome']['genome_fasta'], checkIfExists: true)
+                ]
+
+                haplotigs = [
+                    [ id:'test', single_end:true ], []
+                ]
+
+                input[0] = FASTK_FASTK.out.hist
+                            | join( FASTK_FASTK.out.ktab )
+                            | join( Channel.value( assembly ) )
+                            | join( Channel.value( haplotigs ) )
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+    }
+
+    test("single_minimal_stub") {
+
+        options '-stub'
+
+        when {
+            process {
+                """
+                assembly = [
+                    [ id:'test', single_end:true ], // meta map
+                    file(params.test_data['homo_sapiens']['genome']['genome_fasta'], checkIfExists: true)
+                ]
+
+                haplotigs = [
+                    [ id:'test', single_end:true ], []
+                ]
+
+                input[0] = FASTK_FASTK.out.hist
+                            | join( FASTK_FASTK.out.ktab )
+                            | join( Channel.value( assembly ) )
+                            | join( Channel.value( haplotigs ) )
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+    }
+
+    test("multiple_minimal_stub") {
+
+        options '-stub'
+
+        when {
+            process {
+                """
+                assembly = [
+                    [ id:'test', single_end:true ], // meta map
+                    file(params.test_data['homo_sapiens']['genome']['genome_fasta'], checkIfExists: true)
+                ]
+
+                haplotigs = [
+                    [ id:'test', single_end:true ],
+                    file(params.test_data['homo_sapiens']['genome']['genome2_fasta'], checkIfExists: true)
+                ]
+
+                input[0] = FASTK_FASTK.out.hist
+                            | join( FASTK_FASTK.out.ktab )
+                            | join( Channel.value( assembly ) )
+                            | join( Channel.value( haplotigs ) )
+                """
+            }
+        }
+
+        then {
+            assertAll(
+                { assert process.success },
+                { assert snapshot(process.out).match() }
+            )
+        }
+    }
+
+}

************************************************************
